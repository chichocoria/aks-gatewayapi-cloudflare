# k8s/nginx-fabric-gateway/redirect.yaml
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: global-http-to-https
  namespace: nginx-gateway # Debe estar en el mismo namespace del Gateway
spec:
  parentRefs:
  - name: gateway-principal
    namespace: nginx-gateway
    sectionName: http # Se vincula explícitamente al listener HTTP del puerto 80
  
  hostnames:
  - "*.chicho.com.ar" # Debe coincidir con lo que definiste en el Gateway
  
  rules:
  - matches:
    - path:
        type: PathPrefix
        value: /
    filters:
    - type: RequestRedirect
      requestRedirect:
        scheme: https
        statusCode: 301 # Redirección permanente